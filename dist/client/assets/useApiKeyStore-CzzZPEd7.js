import{f as y,ac as c,ad as l}from"./main-Cyh8r9PM.js";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],A=y("check",p);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],I=y("info",K),m=1,d=()=>new Date().toISOString().split("T")[0],f=c()(l((t,r)=>({currentKeyIndex:0,lastUpdated:Date.now(),totalKeys:1,rateLimitedKeys:{},openaiApiKey:"",anthropicApiKey:"",geminiApiKey:"",grokApiKey:"",setCurrentKeyIndex:e=>{t({currentKeyIndex:e,lastUpdated:Date.now()})},markKeyAsRateLimited:e=>{const i=d();t(a=>({rateLimitedKeys:{...a.rateLimitedKeys,[e]:i}})),console.log(`ðŸš« API key #${e+1} marked as rate limited until tomorrow`)},isKeyRateLimited:e=>{const{rateLimitedKeys:i}=r(),a=i[e];if(!a)return!1;const n=d();return a===n},clearExpiredRateLimits:()=>{const{rateLimitedKeys:e}=r(),i=d(),a={};for(const[n,o]of Object.entries(e))o===i&&(a[Number.parseInt(n,10)]=o);t({rateLimitedKeys:a})},getNextAvailableKeyIndex:()=>{const{totalKeys:e,isKeyRateLimited:i}=r();r().clearExpiredRateLimits();for(let a=0;a<e;a++)if(!i(a))return a;return null},cycleToNext:()=>{const{currentKeyIndex:e,totalKeys:i,getNextAvailableKeyIndex:a}=r();if(i<=1)return e;r().clearExpiredRateLimits();let n=(e+1)%i,o=0;for(;o<i;){if(!r().isKeyRateLimited(n))return t({currentKeyIndex:n,lastUpdated:Date.now()}),console.log(`ðŸ”„ Cycling to API key #${n+1}`),n;n=(n+1)%i,o++}const s=a();return s!==null?(t({currentKeyIndex:s,lastUpdated:Date.now()}),console.log(`ðŸ”„ Cycling to API key #${s+1}`),s):(console.error("ðŸš« All API keys are rate limited!"),null)},resetToFirst:()=>{r().clearExpiredRateLimits();const e=r().getNextAvailableKeyIndex(),i=e!==null?e:0;t({currentKeyIndex:i,lastUpdated:Date.now()}),console.log(`ðŸ”„ Reset to ${e!==null?"first available":"first"} API key #${i+1}`)},updateLastUpdated:()=>{t({lastUpdated:Date.now()})},setTotalKeys:e=>{t({totalKeys:e})},setOpenaiApiKey:e=>t({openaiApiKey:e}),setAnthropicApiKey:e=>t({anthropicApiKey:e}),setGeminiApiKey:e=>t({geminiApiKey:e}),setGrokApiKey:e=>t({grokApiKey:e})}),{name:"openrouter-api-key-store",onRehydrateStorage:()=>t=>{if(t){(Date.now()-t.lastUpdated)/36e5>=m&&(t.currentKeyIndex=0,t.lastUpdated=Date.now());const e=d(),i={};if(t.rateLimitedKeys)for(const[a,n]of Object.entries(t.rateLimitedKeys))n===e&&(i[Number.parseInt(a,10)]=n);t.rateLimitedKeys=i}}}));export{A as C,I,f as u};
